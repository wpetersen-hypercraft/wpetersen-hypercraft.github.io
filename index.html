<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hypercraft Configuration Fileserver - Demo</title>
    <style>
        body { font-family: Arial, sans-serif; line-height: 1.6; margin: 0; padding: 20px; }
        table { width: 100%; border-collapse: collapse; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
        tr:nth-child(even) { background-color: #f9f9f9; }
        .folder { cursor: pointer; }
        #breadcrumb { margin-bottom: 10px; }
    </style>
    <base href="/">
</head>
<body>
    <h1>Hypercraft Configuration Fileserver - Demo</h1>
    <p>This is a demo for Hypercraft's Git-based configuration fileserver.</p>
    <div id="breadcrumb"></div>
    <h2>File Explorer</h2>
    <table id="file-explorer">
        <thead>
            <tr>
                <th>Name</th>
                <th>Date</th>
                <th>Size</th>
            </tr>
        </thead>
        <tbody id="file-list"></tbody>
    </table>

    <script>
        const fileList = document.getElementById('file-list');
        const breadcrumb = document.getElementById('breadcrumb');
        const apiBase = 'https://api.github.com/repos/wpetersen-hypercraft/wpetersen-hypercraft.github.io/';
        const rootPath = 'contents';
    
        function getPathFromUrl() {
            let path = window.location.pathname.split('/').filter(Boolean);
            if (path[0] !== rootPath) {
                path.unshift(rootPath);
            }
            return path.join('/');
        }
    
        function fetchFiles(path) {
            fetch(`${apiBase}${path}`)
                .then(response => response.json())
                .then(data => renderFiles(data))
                .catch(error => console.error('Error fetching files:', error));
        }
    
        function renderFiles(files) {
            fileList.innerHTML = '';
            files.forEach(file => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${file.name}</td>
                    <td>${new Date(file.date).toLocaleString()}</td>
                    <td>${file.size}</td>
                `;
                fileList.appendChild(row);
            });
        }
    
        function updateBreadcrumb(path) {
            breadcrumb.innerHTML = path.split('/').map((part, index, arr) => {
                const href = '/' + arr.slice(0, index + 1).join('/');
                return `<a href="${href}">${part}</a>`;
            }).join(' / ');
        }
    
        document.addEventListener('DOMContentLoaded', () => {
            const path = getPathFromUrl();
            updateBreadcrumb(path);
            fetchFiles(path);
        });
    </script>
</body>
</html>
